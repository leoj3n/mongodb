{
  consul: "{{ if .CONSUL }}{{ .CONSUL }}{{ else }}consul{{ end }}:8500",
  logging: {
    level: "DEBUG",
    format: "text"
  },
  jobs: [
    {
      name: "preStart",
      exec: "python /usr/local/bin/manage.py"
    },
    {
      name: "preStop",
      exec: "python /usr/local/bin/manage.py pre_stop"
    },
    {
      name: "mongodb-replicaset",
      port: 27017,
      exec: "mongod --replSet={{ if .REPLICASET }}{{ .REPLICASET }}{{ else }}joyent{{ end }}",
      when: {
        source: "preStart",
        once: "exitSuccess"
      },
      health: {
        exec: "python /usr/local/bin/manage.py health",
        interval: 10,
        ttl: 25
      },
    },
    {
      name: "onchange-mongo",
      exec: "python /usr/local/bin/manage.py on_change",
      when: {
        source: "watch.mongodb-replicaset",
        each: "changed"
      }
    },
  ],
  watches: [
    {
      name: "mongodb-replicaset",
      interval: 2
    }
  ]
}
